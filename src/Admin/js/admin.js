(function(a){a(document).ready(function(){function b(){jQuery.ajax({data:{action:"wp_redisearch_drop_index"},type:"post",url:wpRds.ajaxUrl}).done(function(a){a.data&&c()}).error(function(a){console.log(a)})}function c(){jQuery.ajax({data:{action:"wp_redisearch_add_to_index"},type:"post",url:wpRds.ajaxUrl}).done(function(a){a.data.offset<a.data.found_posts?(e(a.data.offset,a.data.found_posts),c()):(e(a.data.found_posts,a.data.found_posts),h.css("display","inline-block"),d())}).error(function(a){console.log(a)})}function d(){jQuery.ajax({data:{action:"wp_redisearch_write_to_disk"},type:"post",url:wpRds.ajaxUrl}).done(function(a){console.log("Data successfully written to the disk ",a.data)}).error(function(a){console.log("Error writing to the disk ",a)})}function e(b,c){let d=a("#indexBar"),e=a("#statNumDoc"),f=a("#statNumPosts");e.text(b),f.text(c);d.css("width",100*(b/c)+"%")}var f=a(".wprds-feature"),g=a(".indexing-options"),h=a(".start-indexing"),i=a(".resume-indexing");f.on("click",".save-settings",function(c){c.preventDefault();var d=a(this);if(!d.hasClass("disabled")){var e=d.attr("data-feature"),g=f.find(".wprds-feature-"+e),h={},i=g.find(".setting-field");i.each(function(){var b=a(this).attr("type"),c=a(this).attr("data-field-name"),d=a(this).attr("value");"radio"===b?this.checked&&(h[c]=d):h[c]=d}),console.log(h),d.parent().addClass("saving"),a.ajax({method:"post",url:ajaxurl,data:{action:"wp_redisearch_save_feature",feature:e,nonce:wpRds.nonce,settings:h}}).done(function(a){setTimeout(function(){d.parent().removeClass("saving"),"1"===h.active?g.addClass("feature-active"):g.removeClass("feature-active"),a.data.reindex&&b()},700)}).error(function(){setTimeout(function(){g.removeClass("saving"),g.removeClass("feature-active")},700)})}}),g.attr("data-num-docs")==g.attr("data-num-posts")&&i.css("display","none"),h.click(function(a){a.preventDefault(),h.css("display","none"),b()}),i.click(function(a){a.preventDefault(),i.css("display","none"),c()}),function(){let b=a("#indexBar"),c=b.attr("data-num-docs"),d=b.attr("data-num-posts");b.css("width",100*(c/d)+"%")}()})})(jQuery);
